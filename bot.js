const Discord = require('discord.js');
const client = new Discord.Client();
const prefix = '.'

client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
client.user.setGame(`Streming`,"Manager")
  console.log('')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(`[Start] ${new Date()}`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—');
  console.log(`Logged in as * [ " ${client.user.username} " ]`);
  console.log('')
  console.log('Informations :')
  console.log('')
  console.log(`servers! [ " ${client.guilds.size} " ]`);
  console.log(`Users! [ " ${client.users.size} " ]`);
  console.log(`channels! [ " ${client.channels.size} " ]`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(' Bot Is Online')
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('')
});

client.on('message', message => {
    if(message.content.includes('discord.gg')){
                                            if(!message.channel.guild) return message.reply('** advertising me on DM ? ğŸ¤”   **');
        if (!message.member.hasPermissions(['ADMINISTRATOR'])){
        message.delete()
    return message.reply(`** No Invite Links :angry: !**`)
    }
}
});

var temp = {

};

client.on("message",(message) => {
    if (message.channel.type !== "text") return;
    if (!message.content.startsWith(prefix)) return;
    switch(message.content.split(" ")[0].slice(prefix.length)) {
        case "tempon" :
            if (!message.member.hasPermission("MANAGE_CHANNELS")) return message.reply("** You Don't Have Permission `Manage channels` To Do This Command");
            temp[message.guild.id] = {
                work : true,
                channel : "Not Yet"
            };
            message.guild.createChannel("Ø§Ø¶ØºØ· Ù„ØµÙ†Ø¹ Ø±ÙˆÙ… Ù…Ø¤Ù‚Øª").then(c => {
                c.setPosition(1);
                temp[message.guild.id].channel = c.id
                message.channel.send("** Done.**");
            });
        break;
        case "tempof" :
        if (!message.member.hasPermission("MANAGE_CHANNELS")) return message.reply("** You Don't Have Permission `Manage channels` To Do This Command");
        message.guild.channels.get(temp[message.guild.id]).delete();
            temp[message.guild.id] = {
                work : false,
                channel : "Not Yet"
            };
        message.channel.send("** Done.**");
    };
});
client.on("voiceStateUpdate", (o,n) => {
    if (!temp[n.guild.id]) return;
    if (temp[n.guild.id].work == false) return;
    if (n.voiceChannelID == temp[n.guild.id].channel) {
        n.guild.createChannel(n.user.username, 'voice').then(c => {
            n.setVoiceChannel(c);
            c.overwritePermissions(n.user.id, {
                CONNECT:true,
                SPEAK:true,
                MANAGE_CHANNEL:true,
                MUTE_MEMBERS:true,
                DEAFEN_MEMBERS:true,
                MOVE_MEMBERS:true,
                VIEW_CHANNEL:true  
            });
        })
    };
    if (!o.voiceChannel) return;
    if (o.voiceChannel.name == o.user.username) {
        o.voiceChannel.delete();
    };
});

client.on('message', message => {
var prefix = "!";
       if(message.content === prefix + "mutechannel") {
                           if(!message.channel.guild) return message.reply('** This command only for servers**');

   if(!message.member.hasPermission('MANAGE_MESSAGES')) return message.reply(' **__Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª__**');
              message.channel.overwritePermissions(message.guild.id, {
            SEND_MESSAGES: false

              }).then(() => {
                  message.reply("**__ØªÙ… ØªÙ‚ÙÙŠÙ„ Ø§Ù„Ø´Ø§Øª__ âœ… **")
              });
                }
//FIRE BOT
    if(message.content === prefix + "unmutechannel") {
                        if(!message.channel.guild) return message.reply('** This command only for servers**');

   if(!message.member.hasPermission('MANAGE_MESSAGES')) return message.reply('**__Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª__**');
              message.channel.overwritePermissions(message.guild.id, {
            SEND_MESSAGES: true

              }).then(() => {
                  message.reply("**__ØªÙ… ÙØªØ­ Ø§Ù„Ø´Ø§Øª__âœ…**")
              });
    }
       
});

client.on('message', message => {
    var prefix = "!";
if(!message.channel.guild) return;
if(message.content.startsWith(prefix + 'move')) {
 if (message.member.hasPermission("MOVE_MEMBERS")) {
 if (message.mentions.users.size === 0) {
 return message.channel.send("``Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø± Ø§ÙƒØªØ¨ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù…Ø± : " +prefix+ "move [USER]``")
}
if (message.member.voiceChannel != null) {
 if (message.mentions.members.first().voiceChannel != null) {
 var authorchannel = message.member.voiceChannelID;
 var usermentioned = message.mentions.members.first().id;
var embed = new Discord.RichEmbed()
 .setTitle("Succes!")
 .setColor("#000000")
 .setDescription(`Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø³Ø­Ø¨ <@${usermentioned}> Ø§Ù„Ù‰ Ø§Ù„Ø±ÙˆÙ… Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒâœ… `)
var embed = new Discord.RichEmbed()
.setTitle(`You are Moved in ${message.guild.name}`)
 .setColor("RANDOM")
.setDescription(`**<@${message.author.id}> Moved You To His Channel!\nServer --> ${message.guild.name}**`)
 message.guild.members.get(usermentioned).setVoiceChannel(authorchannel).then(m => message.channel.send(embed))
message.guild.members.get(usermentioned).send(embed)
} else {
message.channel.send("``Ù„Ø§ ØªØ³ØªØ·ÙŠØ¹ Ø³Ø­Ø¨ "+ message.mentions.members.first() +" `ÙŠØ¬Ø¨ Ø§Ù† ÙŠÙƒÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø¶Ùˆ ÙÙŠ Ø±ÙˆÙ… ØµÙˆØªÙŠ`")
}
} else {
 message.channel.send("**``ÙŠØ¬Ø¨ Ø§Ù† ØªÙƒÙˆÙ† ÙÙŠ Ø±ÙˆÙ… ØµÙˆØªÙŠ Ù„ÙƒÙŠ ØªÙ‚ÙˆÙ… Ø¨Ø³Ø­Ø¨ Ø§Ù„Ø¹Ø¶Ùˆ Ø£Ù„ÙŠÙƒ``**")
}
} else {
message.react("âŒ")
 }}});
let message_handler = {};
    let tolerancia = [4, 3500]; //4 messages in less than 1200ms = spam
    module.exports = function(bot, callback){
      bot.on('message', message => {
        if(message.author.bot) return;
        if(!message_handler.hasOwnProperty(message.author.id)){
          message_handler[message.author.id] = {};
          message_handler[message.author.id].ultimamessageTS = message.createdTimestamp;
          message_handler[message.author.id].primeiramessageTS = message.createdTimestamp;
          message_handler[message.author.id].messageTracker = 0;
        }
        var mh = message_handler[message.author.id];
        mh.messageTracker++;
        mh.ultimamessageTS = message.createdTimestamp;
        if(mh.messageTracker >= tolerancia[0] && mh.ultimamessageTS <= (mh.primeiramessageTS + tolerancia[1])){
            callback(message);
        } else {
          setTimeout(function(){
            delete message_handler[message.author.id];
            delete mh;
          }, tolerancia[1]);
        }
      });
    }
    
const developers = ["462437279487754240","442670807240671252",""]
const adminprefix = "!";
client.on('message', message => {
    var argresult = message.content.split(` `).slice(1).join(' ');
      if (!developers.includes(message.author.id)) return;
      
  if (message.content.startsWith(adminprefix + 'ply')) {
    client.user.setGame(argresult);
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
     if (message.content === (adminprefix + "leave")) {
    message.guild.leave();        
  } else  
  if (message.content.startsWith(adminprefix + 'wt')) {
  client.user.setActivity(argresult, {type:'WATCHING'});
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
  if (message.content.startsWith(adminprefix + 'ls')) {
  client.user.setActivity(argresult , {type:'LISTENING'});
      message.channel.send(`**âœ…   ${argresult}**`)
  } else 
  if (message.content.startsWith(adminprefix + 'st')) {
    client.user.setGame(argresult, "https://www.twitch.tv/idk");
      message.channel.send(`**âœ…**`)
  }
  if (message.content.startsWith(adminprefix + 'setname')) {
  client.user.setUsername(argresult).then
      message.channel.send(`Changing The Name To ..**${argresult}** `)
} else
if (message.content.startsWith(adminprefix + 'setavatar')) {
  client.user.setAvatar(argresult);
    message.channel.send(`Changing The Avatar To :**${argresult}** `);
}
});

client.on('message', async message => {
  if(message.content.startsWith(prefix + "-tC")) {
    await message.channel.send("Ø§Ø±Ø³Ù„ Ø§Ø³Ù… Ø§Ù„Ø±ÙˆÙ…").then(e => {
    let filter = m => m.author.id === message.author.id
    let name = '';
    let time = '';
    let type = '';
    let limit = '';


    message.channel.awaitMessages(filter, { max: 1, time: 20000, errors: ['time'] })
    .then(collected => {
      name = collected.first().content
      collected.first().delete()



e.edit("Ø§Ø±Ø³Ù„ Ù…Ø¯Ø© Ø§Ù„Ø±ÙˆÙ… Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚ Ù„Ø§Ø§Ù‚Ù„ Ù…Ù† 2 ÙˆÙ„Ø§ Ø§Ø¹Ù„Ù‰ Ù…Ù† 180")
message.channel.awaitMessages(filter, { max: 1, time: 20000, errors: ['time'] })
.then(co => {
if(isNaN(co.first().content)) return message.reply("Ø§Ù„ÙˆÙ‚Øª Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚ ! Ø§Ø±Ù‚Ø§Ù… ÙÙ‚Ø·Ù");
if(co.first().content > 180 || co.first().content < 2) return message.channel.send("Ù„Ø§ Ø§Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªØ§Ù† ÙˆÙ„Ø§ Ø§ÙƒØ«Ø± Ù…Ù† 180 Ø¯Ù‚ÙŠÙ‚Ù‡")
  time = co.first().content
co.first().delete()
  e.edit("Ø§Ø±Ø³Ù„ Ù†ÙˆØ¹ Ø§Ù„Ø±ÙˆÙ… text, voice")
message.channel.awaitMessages(filter, { max: 1, time: 20000, errors: ['time'] })
.then(col => {
  type = col.first().content
col.first().delete()
e.edit("Ø§Ø±Ø³Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØ³ØªØ·ÙŠØ¹ÙˆÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„")
message.channel.awaitMessages(filter, { max: 1, time: 20000, errors: ['time'] })
.then(coll => {
  if(isNaN(coll.first().content)) return message.reply("Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ ÙŠÙƒÙˆÙ† Ø¨Ø§Ù„Ø§Ø±Ù‚Ø§Ù… ÙÙ‚Ø·");
    limit = coll.first().content
coll.first().delete()

  e.edit("Ø¬Ø§Ø±ÙŠ Ø§Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØºØ±ÙÙ‡ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¶Ø§Ø±...")
  message.guild.createChannel(name, type).then(c => {
    c.edit({
      userLimit: limit
    })
    setTimeout(() => {
      c.delete()
      message.channel.send("ØªÙ… Ø§Ù†Ù‚Ø¶Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª")
    }, Math.floor(time*60000))

  })
  e.edit("ØªÙ… Ø§Ù†Ø´Ø§Ø¡ Ø§Ù„ØºØ±ÙÙ‡ Ø§Ø³ØªÙ…ØªØ¹")

})
})
})
})
})

  }
})

client.on('message', async message =>{
  var prefix = "+";  //alpha codes
if (message.author.omar) return; //alpha codes
if (!message.content.startsWith(prefix)) return; //alpha codes
if(!message.channel.guild) return message.channel.send('**Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙÙ‚Ø· Ù„Ù„Ø³ÙŠØ±ÙØ±Ø§Øª**').then(m => m.delete(5000));
if(!message.member.hasPermission('MANAGE_ROLES'));
if(!message.guild.member(client.user).hasPermission("MANAGE_ROLES")) return message.reply("**I Don't Have `MANAGE_ROLES` Permission**").then(msg => msg.delete(6000))
var command = message.content.split(" ")[0];
command = command.slice(prefix.length);
var args = message.content.split(" ").slice(1);
	if(command == "Ø§Ø³ÙƒØª") {
    let tomute = message.guild.member(message.mentions.users.first() || message.guild.members.get(args[0]));
    if(!tomute) return message.reply("**ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ù…Ù†Ø´Ù† Ø§ÙˆÙ„Ø§Ù‘**:x: ") .then(m => m.delete(5000));
    if(tomute.hasPermission("MANAGE_MESSAGES"))return      message.channel.send('**Ù„Ù„Ø£Ø³Ù Ù„Ø§ Ø£Ù…ØªÙ„Ùƒ ØµÙ„Ø§Ø­ÙŠØ©** `MANAGE_MASSAGEES`');
    let muterole = message.guild.roles.find(`name`, "muted");
    //start of create role
    if(!muterole){ //alpha codes
      try{
        muterole = await message.guild.createRole({
          name: "muted",
          color: "#000000",
          permissions:[]
        }) //alpha codes
        message.guild.channels.forEach(async (channel, id) => {
          await channel.overwritePermissions(muterole, {
            SEND_MESSAGES: false,
            ADD_REACTIONS: false
          });
        }); //alpha codes
      }catch(e){ //alpha codes
        console.log(e.stack);
      } //alpha codes
    }
    //end of create role
    let mutetime = args[1];
    if(!mutetime) return message.reply("**ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„Ù…ÙŠÙˆØª**:x:");
  
    await(tomute.addRole(muterole.id));
    message.reply(`<@${tomute.id}> ØªÙ… Ø§Ø¹Ø·Ø§Ø¦Ù‡ Ù…ÙŠÙˆØª ÙˆÙ…Ø¯Ø© Ø§Ù„Ù…ÙŠÙˆØª : ${ms(ms(mutetime))}`);
  
    setTimeout(function(){
      tomute.removeRole(muterole.id);
      message.channel.send(`<@${tomute.id}> **Ø§Ù†Ù‚Ø¶Ù‰ Ø§Ù„ÙˆÙ‚Øª ÙˆØªÙ… ÙÙƒ Ø§Ù„Ù…ÙŠÙˆØª Ø¹Ù† Ø§Ù„Ø´Ø®Øµ**:white_check_mark: `);
    }, ms(mutetime));
  
  
  //alpha codes
  } //alpha codes
});
client.on('message', async message =>{
  var prefix = "+"; //alpha codes
if (message.author.omar) return;
if (!message.content.startsWith(prefix)) return;
if(!message.channel.guild) return message.channel.send('**Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙÙ‚Ø· Ù„Ù„Ø³ÙŠØ±ÙØ±Ø§Øª**').then(m => m.delete(5000));
if(!message.member.hasPermission('MANAGE_ROLES'));
if(!message.guild.member(client.user).hasPermission("MANAGE_ROLES")) return message.reply("**I Don't Have `MANAGE_ROLES` Permission**").then(msg => msg.delete(6000))
var command = message.content.split(" ")[0];
command = command.slice(prefix.length);
var args = message.content.split(" ").slice(1);
if(command === `ÙÙƒ`) {
  if(!message.member.hasPermission("MANAGE_ROLES")) return message.channel.sendMessage("**Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ÙÙƒ Ø¹Ù† Ø§Ù„Ø´Ø®Øµ Ù…ÙŠÙˆØª**:x: ").then(msg => msg.delete(6000))


  let toMute = message.guild.member(message.mentions.users.first()) || message.guild.members.get(args[0]);
  if(!toMute) return message.channel.sendMessage("**Ø¹Ù„ÙŠÙƒ Ø§Ù„Ù…Ù†Ø´Ù† Ø£ÙˆÙ„Ø§Ù‘**:x: ");

  let role = message.guild.roles.find (r => r.name === "muted");
  
  if(!role || !toMute.roles.has(role.id)) return message.channel.sendMessage("**Ù„Ù… ÙŠØªÙ… Ø§Ø¹Ø·Ø§Ø¡ Ù‡Ø°Ù‡ Ø´Ø®Øµ Ù…ÙŠÙˆØª Ù…Ù† Ø§Ù„Ø£Ø³Ø§Ø³**:x:")

  await toMute.removeRole(role)
  message.channel.sendMessage("**Ù„Ù‚Ø¯ ØªÙ… ÙÙƒ Ø§Ù„Ù…ÙŠÙˆØª Ø¹Ù† Ø´Ø®Øµ Ø¨Ù†Ø¬Ø§Ø­**:white_check_mark:");

  return;

  }

}); 

client.on('message', msg => {
  if (msg.content === 'discord.gg') {
   msg.delete(30)
    msg.reply('Ù…Ù…Ù†ÙˆØ¹');
  }
});

client.on('message', msg => {
  if (msg.content === 'ÙƒØ³Ù…Ùƒ') {
   msg.delete(30)
    msg.reply(' Ù…Ù…Ù†ÙˆØ¹ ØªÙ‚ÙˆÙ„ Ø§Ù„ÙØ§Ø¸ Ø¨Ø°ÙŠØ¦Ù‡ Ø®Ø°Ù„Ùƒ ØªØ­Ø°ÙŠØ± Ø§Ù„Ø¬Ø§ÙŠÙ‡ Ù…ÙŠÙˆØª');
  }
});

client.on('message', msg => {
  if (msg.content === 'ÙƒØ³Ù…') {
   msg.delete(30)
    msg.reply(' Ù…Ù…Ù†ÙˆØ¹ ØªÙ‚ÙˆÙ„ Ø§Ù„ÙØ§Ø¸ Ø¨Ø°ÙŠØ¦Ù‡ Ø®Ø°Ù„Ùƒ ØªØ­Ø°ÙŠØ± Ø§Ù„Ø¬Ø§ÙŠÙ‡ Ù…ÙŠÙˆØª');
  }
});

client.on('message', msg => {
  if (msg.content === 'Ø²Ø¨') {
   msg.delete(30)
    msg.reply(' Ù…Ù…Ù†ÙˆØ¹ ØªÙ‚ÙˆÙ„ Ø§Ù„ÙØ§Ø¸ Ø¨Ø°ÙŠØ¦Ù‡ Ø®Ø°Ù„Ùƒ ØªØ­Ø°ÙŠØ± Ø§Ù„Ø¬Ø§ÙŠÙ‡ Ù…ÙŠÙˆØª');
  }
});
client.on('message', msg => {
  if (msg.content === 'Ù„ÙˆØ·ÙŠ') {
   msg.delete(30)
    msg.reply(' Ù…Ù…Ù†ÙˆØ¹ ØªÙ‚ÙˆÙ„ Ø§Ù„ÙØ§Ø¸ Ø¨Ø°ÙŠØ¦Ù‡ Ø®Ø°Ù„Ùƒ ØªØ­Ø°ÙŠØ± Ø§Ù„Ø¬Ø§ÙŠÙ‡ Ù…ÙŠÙˆØª');
  }
});

const bannedwords = [
  "#credit",
  "#profile",
  "!ÙÙˆØ§ÙƒÙ‡",
  "!Ù…Ø±ÙŠÙ…",
  "4stop",
  "3stop",
  "2stop",
  "4skip",
  "3skip",
  "4play",
  "3play",
  "2play",
  "1play",
  "1stop",
  "2skip",
  "1skip"

]
client.on('message', message => {
  var Muted = message.guild.roles.find("name", "muted");
  var warn = message.guild.roles.find("name", "warn");
  if(bannedwords.some(word => message.content.includes(word))) {
  if(message.channel.id !== '484406975661211651') return;
  if (message.author.bot) return;
  if(message.member.roles.has(warn)) return;
  if(!message.member.roles.has(warn.id)) {
  message.member.addRole(warn)
  message.reply("**`ØªÙ… Ø§Ø¹Ø·Ø§Ø¦Ùƒ ØªØ­Ø°ÙŠØ± Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§ÙˆØ§Ù…Ø± Ø§Ù„Ø¨ÙˆØª ÙÙ‰ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ù…` ğŸ˜ **")
  }
  if(message.member.roles.has(warn.id)) {
      message.member.addRole(Muted)
      message.member.removeRole(warn)
      message.reply("**`ØªÙ… Ø§Ø¹Ø·Ø§Ø¦Ùƒ Ù…ÙŠÙˆØª ÙƒØªØ§Ø¨Ù‰ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ø­Ø¯ Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø§Ø¯Ø§Ø±Ø© Ù„Ø§Ø²Ø§Ù„ØªØ©` ğŸ¤**")
  }
  }
  })


	
client.login(process.env.BOT_TOKEN);

